SELECT 
    p.*,
    h.outcome_hba1c, 
    h.outcome_date, 
    h.start_of_blinded_period, 
    h.mean_hba1c, 
    h.median_hba1c, 
    h.std_hba1c, 
    h.last_hba1c_before_blinded_period, 
    h.first_hba1c_on_record, 
    h.slope_of_hba1c_over_time, 
    h.num_hba1c_measurements, 
    h.time_since_last_hba1c, 
    h.mean_hba1c_2_years_prior, 
    h.mean_hba1c_2_to_5_year_prior, 
    h.age_at_first_hba1c_greater_or_equal_to_48,
    h.age_at_start_of_blinded_period,
    b.mean_bmi_in_obs_period,
    b.last_bmi_in_obs_period,
    b.slope_of_bmi_in_obs_period,
    f.diabetic_eye_complications_in_obs_period, 
    f.diabetic_eye_complications_in_outcome_period,
    f.hf_in_obs_period,
    f.hf_in_outcome_period,
    f.neuropathy_in_obs_period,
    f.neuropathy_in_outcome_period,
    f.amputation_in_obs_period,
    f.amputation_in_outcome_period,
    f.renal_in_obs_period,
    f.renal_in_outcome_period,
    f.pvd_in_obs_period,
    f.pvd_in_outcome_period,
    f.mi_in_obs_period,
    f.mi_in_outcome_period,
    f.stroke_in_obs_period,
    f.stroke_in_outcome_period,
    f.dka_in_obs_period,
    f.dka_in_outcome_period
FROM INTELLIGENCE_DEV.AI_CENTRE_FEATURE_STORE.patients_with_diabetes_all_v2 p
JOIN hba1c_features_v1 h ON h.person_id = p.person_id
JOIN BMI_FEATURES_V1 b ON h.person_id = b.person_id
JOIN DIABETIC_OUTCOME_FLAGS_TIMEPERIOD_V1 f ON h.person_id = f.person_id;